# 订单相关的GraphQL操作

# 查询所有订单（带权限过滤）
query GetOrders($userId: ID) {
  orders(filter: { user_created: { id: { _eq: $userId } } }) {
    id
    wechat_user_id {
      id
      nickname
      openid
      headimgurl
      city
      province
    }
    boutique_id {
      id
      name
      address
    }
    total_price
    status
    date_created
    date_updated
    user_created {
      id
      first_name
      last_name
      email
    }
  }
}

# 查询所有订单（管理员用，无权限过滤）
query GetAllOrders {
  orders {
    id
    wechat_user_id {
      id
      nickname
      openid
      headimgurl
      city
      province
    }
    boutique_id {
      id
      name
      address
    }
    total_price
    status
    date_created
    date_updated
    user_created {
      id
      first_name
      last_name
      email
    }
  }
}

# 根据ID查询订单
query GetOrderById($id: ID!) {
  orders_by_id(id: $id) {
    id
    wechat_user_id {
      id
      nickname
      openid
      headimgurl
      city
      province
    }
    boutique_id {
      id
      name
      address
    }
    total_price
    status
    date_created
    date_updated
  }
}

# 查询订单项
query GetOrderItems($orderId: GraphQLStringOrFloat!) {
  order_items(filter: { order_id: { id: { _eq: $orderId } } }) {
    id
    order_id {
      id
    }
    product_id {
      id
      name
      description
    }
    quantity
    price
  }
}

# 创建订单
mutation CreateOrder($data: create_orders_input!) {
  create_orders_item(data: $data) {
    id
    wechat_user_id {
      id
      nickname
    }
    boutique_id {
      id
      name
      address
    }
    total_price
    status
    date_created
    date_updated
  }
}

# 更新订单
mutation UpdateOrder($id: ID!, $data: update_orders_input!) {
  update_orders_item(id: $id, data: $data) {
    id
    wechat_user_id {
      id
      nickname
    }
    boutique_id {
      id
      name
      address
    }
    total_price
    status
    date_created
    date_updated
  }
}

# 删除订单
mutation DeleteOrder($id: ID!) {
  delete_orders_item(id: $id) {
    id
  }
}

# 更新订单状态
mutation UpdateOrderStatus($id: ID!, $status: String!) {
  update_orders_item(id: $id, data: { status: $status }) {
    id
    status
    date_updated
  }
}
